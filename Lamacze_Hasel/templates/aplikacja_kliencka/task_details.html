<head lang="pl">
    {% load staticfiles %}
    <link rel="stylesheet" href="/static/css/bootstrap.css"/>
    <link rel="stylesheet" href="/static/css/bootstrap-theme.css"/>
    <link rel="stylesheet" href="/static/css/jquery-ui.css"/>
    <link rel="stylesheet" href="/static/css/jquery-ui.theme.css"/>
    <link rel="stylesheet" href="/static/css/jquery-ui.structure.css"/>
    <link rel="stylesheet" href="/static/jqGRID/css/ui.jqgrid.css"/>
    <script src="/static/js/jquery-2.1.3.js" type="text/javascript"></script>
    <script src="/static/js/bootstrap.js" type="text/javascript"></script>
    <script src="/static/jqGRID/js/i18n/grid.locale-pl.js" type="text/javascript"></script>
    <script src="/static/jqGRID/js/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script src="/static/jqGRID/js/jquery.jqGrid.min.js" type="text/javascript"></script>
    <script src="/static/js/jquery-ui.min.js" type="text/javascript"></script>
    <meta charset="UTF-8">
    <title>{% block title %}Łamacze Haseł{% endblock %}</title>
</head>
<body>
    <p> Numer zadania: {{ task.id }}</p>
    <p> Klaster: {{ task.cluster }}</p>
    <p> Data utworzenia: {{ task.creation_date }}</p>
    {% if task.end_time %}
    <p> Data zakończenia: {{ task.end_time }}</p>
    {% endif %}
    <p> Status </p>
    <div class="container">
      <div class="progress" style="margin: 2% ">
        <div class="progress-bar progress-bar-striped active" id="progress_bar" role="progressbar"
             aria-valuenow="{{ task.status }}" aria-valuemin="0" aria-valuemax="100" style="width:{{ task.status }}%">
          {{ task.status }}%
        </div>
      </div>
    </div>
    <script>
    $(document).ready(
            function() {
                setInterval(function() {

                    var id = "{{ task.id }}";
                    var url = "/get_status/";
                    $.ajax({
                        url: url,
                        type: "POST",
                        data: {'id': id},
                        success: function(data){
                            message = '<span class="' + data.status + '">' + data.result + '</span> ';
                            message = ( data.status == 'success' ) ? message + data.fileLink : message;
                            status = data.task_status + "%";
                            $("#progress_bar").text(status).css({"width":status, "aria_valuenow": data.task_status});
                        }
                   })
                }, 3000);
            });
</script>
</body>